

---
title: "What's the Relationship Between # of Lines and # of Functions in Different Languages?"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# here is where I would like a block image to go for each lesson. Imagery is important to engage the learner.
```
## "Ugh, why do we have to write this in *that* language?"
Whether you're groaning over having to translate your code into some other language, or arguing profusely over the benefits of some obscure package, it's likely that you've considered the differences between programming languages before.  Perhaps you're such a language switcher that your semicolons get mixed up with your whitespace and you search for way too long for the `switch` statement in Python. Perhaps you're committed to your language and never touching anything else, because yours is *clearly* superior. But whatever the case, we are going to explore some differences between languages today. 

![](figures/languages.png)

## What does it mean to be "different"?
One of the most common statistical tools is to compare samples in order to detect a significant difference. This might mean detecting a difference in their averages, or more formally, detecting that they are drawn from truly different generating processes in the world. More on that: whenever we draw a sample, we are trying to capture a sample of some phenomenon happening; there is some process (that we can't quite know) that dictates how that data turns out. In this example. it could be that there is something inherent about Python vs. JavaScript interpreters that make them actually different. Or perhaps it could be that Python *users* are different from JavaScript *users*, with one tending to be more verbose than the other. We are trying to draw samples in order to capture patterns in the world, and those patterns come from some causal relationship. With comparisons, we really *cannot* determine causality, but this is to get us thinking about the "why" when we do see a difference afterall. If we see a difference in average number of lines for Python vs. JavaScript, is there something inherent about writing Python code that lends nicely to one liners? Or is it the population of Python users? Or is it the specific Python code we grabbed? These are all questions we need to think about when we hear someone say "Oh please, use this language instead! It's way better at... blah blah blah." So let's get to the bottom of those "blah blah blah" claims, shall we?


```{r message=FALSE}
library(ggplot2)
library(dplyr)

```

## How does the number of lines relate to the number of function definitions?

You're faced with our question: How does the number of lines of code compare with the number of function definitions between languages? Immediately, I think about the many times I've seen code that copy-and-pastes the same block of code over and over, without declaring it as a function. (*Remember your coding etiquette, people! If you copy and paste 3 times, it's time for a function.*) But I'm also reminded of the massive code libaries, containing a function for *everything*, with hundreds of lines of code for all of those functions. Try to reflect on your own intuition about if the number of lines has a relationship to the number of function declarations in a program. Maybe take a look at a program you've written: how many lines? how many function declarations? And did it change over the duration of your first programming course? (I personally went from copy-and-pasting a hard-coded mess into neat little helper functions as I had to face my own monsterous and unmaintainable code.) But wouldn't that *shorten* my program length? You can imagine that the larger the program, the more function definitions there are. But you can also imagine just the opposite.

## How do I parse a programming language? Abstract Syntax Trees
We need  to parse a program in order to count up the number of function definitions. The most straightforward way of doing this might be to look for the "def" keyword in a language like Python. Imagine you were writing this yourself; trying to count the number of function definitions in a piece of code. You might rely on good old fashioned string matching: `for line in program: if "def" in line: function_count +=1` That's a fine start but it gets very messy, *fast*. Luckily, we can rely on something called an **Abstract Syntax Tree**.

```{r}

py = read.csv("../bin/PythonFiles/Stats/python_stats.csv")
colnames(py) <- c("Lines","FunctionDefs")
length(py$Lines)
#240 python programs
py$Language = "Python"

# JS programs
js = read.csv("../bin/JSFiles/Stats/js_stats.csv")
colnames(js) <- c("Lines","FunctionDefs")
js$Language= "JavaScript"

data = rbind(py,js)
```
## Don't Compare Apples to Oranges

```{r}
#we need to normalize this stuff
data = data %>% 
  group_by(Language) %>%
  mutate(Lines.normed = scale(Lines)) %>%
  mutate(FunctionDefs.normed = scale(FunctionDefs))



```

```{r}

plt = ggplot(data,aes(Lines.normed,FunctionDefs.normed))+
  facet_wrap(~Language)+
  geom_point(aes(colour=Language),size=1, show.legend=FALSE)+
  #geom_vline(xintercept=mean(data$Lines),colour="red",linetype="dashed")+
  #geom_hline(yintercept=mean(data$FunctionDefs),colour="red",linetype="dashed")+
  ggtitle("Scaled Lines v. Function Definitions")+
  xlab("Number of Lines (z score)")+
  ylab("Number of Function Definitions (z score)")+
  
  theme_bw()
  
plt
#ggsave("lines_and_defs.png",plt)


```



```{r}
cor(data$FunctionDefs[data$Language=="JavaScript"],data$Lines[data$Language=="JavaScript"])

data2 = data[data$FunctionDefs>=10 & data$Lines>=200,]
cor(data2$FunctionDefs,data2$Lines)
```

## Normality Matters
We are all about finding differences, but comparing those differences is a delicate business. We learned that we can't compare Apples to Oranges, so we **normalized** our data. Sometimes, that's enough to be able to draw direct comparisons. 
```{r}
plt = ggplot(data, aes(FunctionDefs.normed,fill=Language))+
  geom_histogram()+
  #geom_density()+
  facet_wrap(~Language)+
  theme_bw()
plt
shapiro.test(data$FunctionDefs[data$Language=="JavaScript"])



```



